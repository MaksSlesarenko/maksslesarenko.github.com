\hypertarget{AbstractEntity_8php}{\section{Abstract\-Entity.\-php}
\label{AbstractEntity_8php}\index{Db/\-Schema/\-Abstract\-Entity.\-php@{Db/\-Schema/\-Abstract\-Entity.\-php}}
}

\begin{DoxyCode}
00001 <?php
\hypertarget{AbstractEntity_8php_source_l00029}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity}{00029} \textcolor{keyword}{abstract} \textcolor{keyword}{class }\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity}{ZendDbSchema\_Db\_Schema\_AbstractEntity}
00030     \textcolor{keyword}{extends} \hyperlink{classZendDbSchema__Db__Schema__AbstractSchema}{ZendDbSchema\_Db\_Schema\_AbstractSchema}
00031 \{
00035     \textcolor{keyword}{protected} $\_adapter;
00036 
00040     \textcolor{keyword}{protected} $\_generator;
00041 
00047     \textcolor{keyword}{protected} $\_cleanSchema  = array();
00048 
00054     \textcolor{keyword}{abstract} \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ab317ba1e66cc14d78922314962f7d0ff}{\_doReload}();
00055 
\hypertarget{AbstractEntity_8php_source_l00062}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a3aee3f3f8c86d17aeba34b520c0c407d}{00062}     \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a3aee3f3f8c86d17aeba34b520c0c407d}{\_delete}()
00063     \{
00064     \}
00065 
\hypertarget{AbstractEntity_8php_source_l00072}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a29b327cec2bd92fcdaecd4854c72efd7}{00072}     \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a29b327cec2bd92fcdaecd4854c72efd7}{\_postDelete}()
00073     \{
00074     \}
00075 
\hypertarget{AbstractEntity_8php_source_l00082}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a453f0e0a50f718a89f7f024e61a3e2c2}{00082}     \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a453f0e0a50f718a89f7f024e61a3e2c2}{\_save}()
00083     \{
00084     \}
00085 
\hypertarget{AbstractEntity_8php_source_l00092}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_af43e389f058e86574090ef18a335e4ce}{00092}     \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_af43e389f058e86574090ef18a335e4ce}{\_postSave}()
00093     \{
00094     \}
00095 
\hypertarget{AbstractEntity_8php_source_l00101}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aa35a80275bd3c811dd8ad39835a985a9}{00101}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aa35a80275bd3c811dd8ad39835a985a9}{reload}()
00102     \{
00103         $this->\_cleanSchema = array();
00104 
00105         \textcolor{keywordflow}{if} ($name = $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_adacb1417b461310c5c87f72c459c1985}{getOriginName}()) \{
00106             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ab317ba1e66cc14d78922314962f7d0ff}{\_doReload}();
00107         \}
00108         \textcolor{keywordflow}{return} $this;
00109     \}
00110 
\hypertarget{AbstractEntity_8php_source_l00117}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_abee9675e11d86dace1abed3d94a0fda1}{00117}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_abee9675e11d86dace1abed3d94a0fda1}{refresh}($param = null)
00118     \{
00119         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aa35a80275bd3c811dd8ad39835a985a9}{reload}();
00120 
00121         \textcolor{keywordflow}{return} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_abee9675e11d86dace1abed3d94a0fda1}{parent::refresh}($param);
00122     \}
00123 
\hypertarget{AbstractEntity_8php_source_l00129}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_af7158a6eb788024abc42ba131bc7a8f1}{00129}     \textcolor{keyword}{protected} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_af7158a6eb788024abc42ba131bc7a8f1}{\_getCleanSchema}()
00130     \{
00131         \textcolor{keywordflow}{return} $this->\_cleanSchema;
00132     \}
00133 
\hypertarget{AbstractEntity_8php_source_l00141}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ad92ca2449257a587b336367f109cdde2}{00141}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ad92ca2449257a587b336367f109cdde2}{\_\_wakeup}()
00142     \{
00143         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aa35a80275bd3c811dd8ad39835a985a9}{reload}();
00144     \}
00145 
00146 
\hypertarget{AbstractEntity_8php_source_l00153}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a7ddb87869e3021260c12bb57df4ba8c1}{00153}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a7ddb87869e3021260c12bb57df4ba8c1}{exec}($sql)
00154     \{
00155         $queries = explode(\textcolor{charliteral}{';'}, $sql);
00156         $queries = array\_filter($queries);
00157 
00158         \textcolor{keywordflow}{foreach} ($queries as $query) \{
00159             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ad6dfc39cc6d92633fd92170db18c9573}{getAdapter}()->exec($query);
00160         \}
00161         \textcolor{keywordflow}{return} $this;
00162     \}
00163 
\hypertarget{AbstractEntity_8php_source_l00169}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a5b1c93da76c3708f90d330b4643e55b2}{00169}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a5b1c93da76c3708f90d330b4643e55b2}{save}()
00170     \{
00171         \textcolor{keywordflow}{if} ($this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_ae859790a91bbcb9c4dc52a6139e5999e}{isDirty}()) \{
00172 
00173             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a453f0e0a50f718a89f7f024e61a3e2c2}{\_save}();
00174 
00175             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a7ddb87869e3021260c12bb57df4ba8c1}{exec}($this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_ada5af8e6e7a4c5407b7ca67d03900b31}{toSql}($this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_a1680a8fd22360f74d29b641d7257a52f}{isExist}()));
00176 
00177             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_af43e389f058e86574090ef18a335e4ce}{\_postSave}();
00178 
00179             $this->\_name = $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_a55787c21deddba427842809d589c2df6}{getName}();
00180 
00181             $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_abee9675e11d86dace1abed3d94a0fda1}{refresh}();
00182             \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00183         \}
00184         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00185     \}
00186 
\hypertarget{AbstractEntity_8php_source_l00192}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a26fcff2268495fcdbfa265f394ee93d9}{00192}     \textcolor{keyword}{public} \textcolor{keyword}{function} \textcolor{keyword}{delete}()
00193     \{
00194         \textcolor{keywordflow}{if} (!$this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_a1680a8fd22360f74d29b641d7257a52f}{isExist}()) \{
00195             \textcolor{keywordflow}{throw} \textcolor{keyword}{new} \hyperlink{classZendDbSchema__Db__Schema__Exception}{ZendDbSchema\_Db\_Schema\_Exception}
      (\textcolor{stringliteral}{'Cannot delete not existing schema'});
00196         \}
00197         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a3aee3f3f8c86d17aeba34b520c0c407d}{\_delete}();
00198 
00199         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a7ddb87869e3021260c12bb57df4ba8c1}{exec}($this->\hyperlink{classZendDbSchema__Db__Schema__AbstractSchema_aec661ede88f500caaf2a09e98c31d3b0}{getDropSql}());
00200 
00201         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a29b327cec2bd92fcdaecd4854c72efd7}{\_postDelete}();
00202 
00203         $this->\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_abee9675e11d86dace1abed3d94a0fda1}{refresh}();
00204         \textcolor{keywordflow}{return} $this;
00205     \}
00206 
\hypertarget{AbstractEntity_8php_source_l00212}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a72a4acb81535f7110a49dfb3755ac48b}{00212}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_a72a4acb81535f7110a49dfb3755ac48b}{getGenerator}()
00213     \{
00214         \textcolor{keywordflow}{return} $this->\_generator;
00215     \}
00216 
\hypertarget{AbstractEntity_8php_source_l00222}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ad6dfc39cc6d92633fd92170db18c9573}{00222}     \textcolor{keyword}{public} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_ad6dfc39cc6d92633fd92170db18c9573}{getAdapter}()
00223     \{
00224         \textcolor{keywordflow}{return} $this->\_adapter;
00225     \}
00226 
\hypertarget{AbstractEntity_8php_source_l00233}{}\hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aeeb617d5d385796ccbe95e0aa85cf491}{00233}     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{function} \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aeeb617d5d385796ccbe95e0aa85cf491}{getDefaultAdapter}()
00234     \{
00235         $defaultAdapter = \hyperlink{classZendDbSchema__Db__Schema__AbstractEntity_aeeb617d5d385796ccbe95e0aa85cf491}{Zend\_Db\_Table::getDefaultAdapter}
      ();
00236         $config = $defaultAdapter->getConfig();
00237         \textcolor{keywordflow}{switch} (\textcolor{keyword}{true}) \{
00238             \textcolor{keywordflow}{case} $defaultAdapter instanceof Zend\_Db\_Adapter\_Mysqli:
00239                 $adapter = \textcolor{keyword}{new} \hyperlink{classZendDbSchema__Db__Adapter__Mysqli}{ZendDbSchema\_Db\_Adapter\_Mysqli}
      ($config);
00240                 \textcolor{keywordflow}{break};
00241             \textcolor{keywordflow}{case} $defaultAdapter instanceof Zend\_Db\_Adapter\_Pdo\_Mysql:
00242                 $adapter = \textcolor{keyword}{new} \hyperlink{classZendDbSchema__Db__Adapter__Pdo__Mysql}{ZendDbSchema\_Db\_Adapter\_Pdo\_Mysql}
      ($config);
00243                 \textcolor{keywordflow}{break};
00244             \textcolor{keywordflow}{default}:
00245                 $adapterType = get\_class($defaultAdapter);
00246                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} \hyperlink{classZendDbSchema__Db__Schema__Exception}{ZendDbSchema\_Db\_Schema\_Exception}
      (
00247                     \textcolor{stringliteral}{"Adapter '$adapterType' not supported"}
00248                 );
00249         \}
00250         \textcolor{keywordflow}{return} $adapter;
00251     \}
00252 \}
\end{DoxyCode}
